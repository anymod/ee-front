<style>
  ee-canvas .nav-tabs-container,
  ee-canvas .ee-canvas-container {
    overflow-x: scroll;
    overflow-y: hidden;
  }
  ee-canvas .nav.nav-tabs { min-width: {{ layers.length * 74 + 270 }}px; }
  ee-canvas .nav-tabs > li { margin-bottom: -2px; }
  ee-canvas .nav-tabs > li > a {
    padding: 5px;
    min-height: 77px;
    border-radius: 5px;
  }
  ee-canvas .nav-tabs > li.active > a,
  ee-canvas .nav-tabs > li.active > a:hover,
  ee-canvas .nav-tabs > li.active > a:focus {
    border: 1px solid #03A9F4;
  }
</style>

<div class="well white-background box-shadow pad-5 position-relative">
  <div class="nav-tabs-container">
    <ul class="nav nav-tabs">
      <li ng-repeat="layer in layers | reverse" ng-class="{ active: layer.active }" class="text-center">
        <a href ng-click="focusLayer(layer)" class="text-center text-muted">
          <div style="height: 60px;">
            <span ng-if="layer.type == 'rect' || layer.type == 'ellipse'">Shape<br><i class="fa fa-3x fa-square" ng-style="{ color: layer.fill }"></i></span>
            <span ng-if="layer.type == 'i-text'">Text<br><i class="fa fa-3x fa-font" ng-style="{ color: layer.fill }"></i></span>
            <span ng-if="layer.type == 'image'">Image<br><img ng-src='{{ layer.src }}' class="vert-5 margin-bottom-0" style="max-width: 46px; max-height: 40px;"></span>
          </div>
          <div ng-show="layers.length > 1"
            class="btn-group vert-5 margin-bottom-0"
            style="height:30px;">
            <div class="btn btn-default pad-5" ng-disabled="$first" ng-click="reorderLayerBy(layer, 1)">
              <small ng-show="$first">Top</small>
              <i ng-hide="$first" class="fa fa-fw fa-long-arrow-left"></i>
            </div>
            <div class="btn btn-default pad-5" ng-disabled="$last" ng-click="reorderLayerBy(layer, -1)">
              <small ng-show="$last">Bottom</small>
              <i ng-hide="$last" class="fa fa-fw fa-long-arrow-right"></i>
            </div>
          </div>
        </a>
      </li>
      <!-- Add Layer -->
      <li ng-repeat="type in ['Text','Shape','Image','Product']" ng-class="{ active: overlay == type }" class="text-center">
        <a href ng-click="setOverlay(type)" class="text-center text-muted">
          <span ng-bind="type"></span><br><i class="fa fa-3x fa-plus"></i>
        </a>
        <div ng-show="layers.length > 1" style="height: 34px; width: 100%;"></div>
      </li>
      <!-- /Add Layer -->
    </ul>
  </div>
  <div class="position-relative">
    <div>
      <!-- i-text toolset -->
      <div ng-show="toolset.tab == 'i-text'" class="btn-group">
        <span class="btn-group" auto-close="outsideClick" uib-dropdown>
          <div class="btn btn-default vert-5" uib-dropdown-toggle>
            Color <i class="fa fa-caret-down"></i>
          </div>
          <ul class="dropdown-menu" uib-dropdown-menu>
            <li class="pad-5">
              <ee-web-colorpicker always-open="'true'"></ee-web-colorpicker>
            </li>
          </ul>
        </span>
        <span class="btn-group" auto-close="outsideClick" uib-dropdown>
          <div class="btn btn-default vert-5" uib-dropdown-toggle>
            Font <i class="fa fa-caret-down"></i>
          </div>
          <ul class="dropdown-menu" uib-dropdown-menu>
            <li class="pad-5">
              <ee-font-selector></ee-font-selector>
            </li>
          </ul>
        </span>
        <div class="btn btn-default vert-5" ng-click="toggleFontSetting('bold')" ng-class="{ active: toolset.bold }"><i class="fa fa-bold"></i></div>
        <div class="btn btn-default vert-5" ng-click="toggleFontSetting('italic')" ng-class="{ active: toolset.italic }"><i class="fa fa-italic"></i></div>
        <div class="btn btn-default vert-5" ng-click="removeActiveObject()">Remove</div>
      </div>
      <!-- /i-text toolset -->
      <!-- image toolset -->
      <div ng-show="toolset.tab == 'image'" class="btn-group">
        <span class="btn-group" uib-dropdown auto-close="outsideClick">
          <div class="btn btn-default vert-5" uib-dropdown-toggle>
            Remove white <i class="fa fa-caret-down"></i>
          </div>
          <ul class="dropdown-menu pad-10" style="width: 300px" uib-dropdown-menu>
            <li>Color Range <input type="range" min=0 max=26 ng-model="toolset.whitespaceThreshold" ng-change="updateWhitespace()" class="pull-right vert-2" style="width: 190px;"/></li>
            <li class="divider"></li>
            <li>Distance <input type="range" min=1 max=48 ng-model="toolset.whitespaceDistance" ng-change="updateWhitespace()" class="pull-right vert-2" style="width: 190px;"/></li>
          </ul>
        </span>
        <div class="btn btn-default vert-5" ng-click="removeActiveObject()">Remove</div>
      </div>
      <!-- /image toolset -->
      <!-- shape toolset -->
      <div ng-show="toolset.tab == 'rect' || toolset.tab == 'ellipse'" class="btn-group">
        <span class="btn-group" auto-close="outsideClick" uib-dropdown>
          <div class="btn btn-default vert-5" uib-dropdown-toggle>
            Color <i class="fa fa-caret-down"></i>
          </div>
          <ul class="dropdown-menu" uib-dropdown-menu>
            <li class="pad-5">
              <ee-web-colorpicker always-open="'true'"></ee-web-colorpicker>
            </li>
          </ul>
        </span>
        <span class="btn-group" auto-close="outsideClick" uib-dropdown>
          <div class="btn btn-default vert-5" uib-dropdown-toggle>
            Transparency <i class="fa fa-caret-down"></i>
          </div>
          <ul class="dropdown-menu pad-10" style="width: 200px" uib-dropdown-menu>
            <li><input type="range" min=0 max=0.9 step=0.1 ng-model="toolset.transparency" ng-change="updateTransparency()" class="pull-right vert-2"/></li>
          </ul>
        </span>
        <div class="btn btn-default vert-5" ng-click="removeActiveObject()">Remove</div>
      </div>
      <!-- /shape toolset -->
      <!-- background color toolset -->
      <div class="btn-group" auto-close="outsideClick" uib-dropdown ng-show="!toolset.tab">
        <div class="btn btn-default vert-5" uib-dropdown-toggle>
          Background color <i class="fa fa-caret-down"></i>
        </div>
        <ul class="dropdown-menu" uib-dropdown-menu>
          <li class="pad-5">
            <ee-web-colorpicker always-open="'true'"></ee-web-colorpicker>
          </li>
        </ul>
      </div>
      <!-- /background color toolset -->

      <!-- <uib-tabset ng-if="false">
        <uib-tab heading="Layers" select="unfocusBackground()" active="tab.layers">
          <div class="btn-group">
            <div class="btn btn-default vert-5" ng-click="setOverlay('Product')" ng-class="{ active: overlay.product }" ng-show="products.length > 0">Add product</div>
            <span class="btn-group" auto-close="outsideClick" is-open="overlay.text" uib-dropdown>
              <div class="btn btn-default vert-5" uib-dropdown-toggle>Add text</div>
              <ul class="dropdown-menu pad-0" style="width: 300px;" uib-dropdown-menu>
                <li class="margin-7">
                  <input type="text" class="form-control inline-block" style="width: 225px;" ng-model="textToAdd"/>
                  <div class="btn btn-default" ng-click="addText(textToAdd); overlay.text = false; textToAdd = null;">Add</div>
                </li>
              </ul>
            </span>
            <span class="btn-group" auto-close="outsideClick" is-open="overlay.shape" uib-dropdown>
              <div class="btn btn-default vert-5" uib-dropdown-toggle>Add shape</div>
              <ul class="dropdown-menu pad-0" uib-dropdown-menu>
                <li class="margin-7">
                  <div style="width: 60px; height: 40px; background: #6B5C84;" class="inline-block margin-5 hover-pointer" ng-click="addShape('rect')"></div>
                  <div style="width: 60px; height: 40px; background: #6B5C84;" class="inline-block margin-5 hover-pointer round-50-pct" ng-click="addShape('ellipse')"></div>
                </li>
              </ul>
            </span>
          </div>
          <div class="btn-group pull-right" ng-show="toolset.tab == 'i-text'">
            <div class="btn btn-default vert-5" ng-click="toggleFontSetting('bold')" ng-class="{ active: toolset.bold }"><i class="fa fa-fw fa-bold"></i></div>
            <div class="btn btn-default vert-5" ng-click="toggleFontSetting('italic')" ng-class="{ active: toolset.italic }"><i class="fa fa-fw fa-italic"></i></div>
            <div class="btn btn-default vert-5" ng-click="toggleFontSetting('underline')" ng-class="{ active: toolset.underline }"><i class="fa fa-fw fa-underline"></i></div>
            <span class="btn-group" auto-close="outsideClick" uib-dropdown>
              <div class="btn btn-default vert-5" uib-dropdown-toggle>
                Font <i class="fa fa-caret-down"></i>
              </div>
              <ul class="dropdown-menu" uib-dropdown-menu>
                <li class="pad-5">
                  <ee-font-selector></ee-font-selector>
                </li>
              </ul>
            </span>
            <span class="btn-group" auto-close="outsideClick" uib-dropdown>
              <div class="btn btn-default vert-5" uib-dropdown-toggle>
                Color <i class="fa fa-caret-down"></i>
              </div>
              <ul class="dropdown-menu" uib-dropdown-menu>
                <li class="pad-5">
                  <ee-web-colorpicker always-open="'true'"></ee-web-colorpicker>
                </li>
              </ul>
            </span>
            <div class="btn btn-default vert-5" ng-click="removeActiveObject()">Remove</div>
          </div>
          <div class="btn-group pull-right" ng-show="toolset.tab == 'image'">
            <span class="btn-group" uib-dropdown auto-close="outsideClick">
              <div class="btn btn-default vert-5" uib-dropdown-toggle>
                Remove white <i class="fa fa-caret-down"></i>
              </div>
              <ul class="dropdown-menu dropdown-menu-right pad-10" style="width: 300px" uib-dropdown-menu>
                <li>Color Range <input type="range" min=0 max=26 ng-model="toolset.whitespaceThreshold" ng-change="updateWhitespace()" class="pull-right vert-2" style="width: 190px;"/></li>
                <li class="divider"></li>
                <li>Distance <input type="range" min=1 max=48 ng-model="toolset.whitespaceDistance" ng-change="updateWhitespace()" class="pull-right vert-2" style="width: 190px;"/></li>
              </ul>
            </span>
            <div class="btn btn-default vert-5" ng-click="removeActiveObject()">Remove</div>
          </div>
          <div class="btn-group pull-right" ng-show="toolset.tab == 'rect' || toolset.tab == 'ellipse'">
            <span class="btn-group" auto-close="outsideClick" uib-dropdown>
              <div class="btn btn-default vert-5" uib-dropdown-toggle>
                Color <i class="fa fa-caret-down"></i>
              </div>
              <ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu>
                <li class="pad-5">
                  <ee-web-colorpicker always-open="'true'"></ee-web-colorpicker>
                </li>
              </ul>
            </span>
            <span class="btn-group" auto-close="outsideClick" uib-dropdown>
              <div class="btn btn-default vert-5" uib-dropdown-toggle>
                Transparency <i class="fa fa-caret-down"></i>
              </div>
              <ul class="dropdown-menu dropdown-menu-right pad-10" style="width: 200px" uib-dropdown-menu>
                <li><input type="range" min=0 max=0.9 step=0.1 ng-model="toolset.transparency" ng-change="updateTransparency()" class="pull-right vert-2"/></li>
              </ul>
            </span>
            <div class="btn btn-default vert-5" ng-click="removeActiveObject()">Remove</div>
          </div>
          <div class="btn-group pull-right" auto-close="outsideClick" uib-dropdown ng-show="!toolset.tab">
            <div class="btn btn-default vert-5" uib-dropdown-toggle>
              Background color <i class="fa fa-caret-down"></i>
            </div>
            <ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu>
              <li class="pad-5">
                <ee-web-colorpicker always-open="'true'"></ee-web-colorpicker>
              </li>
            </ul>
          </div>
        </uib-tab>
        <uib-tab heading="Background image" select="focusBackground()" active="tab.background">
          <div>
            <div class="btn-group">
              <div class="btn btn-default vert-5" style="cursor: auto;">
                <div class="overflow-hidden" style="max-width: 180px;">
                  <ee-cloudinary-upload meta="collection" attr-target="'1000x1000'"></ee-cloudinary-upload>
                </div>
              </div>
              <div class="btn btn-default vert-5" ng-click="setOverlay('Image')">Search for image</div>
            </div>
            <div class="btn-group pull-right">
              <div class="btn btn-default vert-5" ng-if="backgroundSet()" ng-click="removeBackgroundImage()">Remove background image</div>
            </div>
          </div>
        </uib-tab>
      </uib-tabset> -->

      <!-- Overlays -->
      <div ng-show="overlay"
        class="white-background position-absolute top-left-bottom-right-0 pad-10"
        style="z-index: 1000; overflow-y: scroll;">
        <!-- text overlay -->
        <form ng-show="overlay == 'Text'"
          ng-submit="addText()"
          class="form form-inline">
          <input type="text" class="form-control input-lg inline-block" ng-model="textToAdd"/>
          <button type="submit" class="btn btn-lg btn-default">Add</button>
        </form>
        <!-- /text overlay -->
        <!-- shape overlay -->
        <div ng-show="overlay == 'Shape'">
          <div style="width: 60px; height: 40px; background: #6B5C84;" class="inline-block margin-5 hover-pointer" ng-click="addShape('rect')"></div>
          <div style="width: 60px; height: 40px; background: #6B5C84;" class="inline-block margin-5 hover-pointer round-50-pct" ng-click="addShape('ellipse')"></div>
        </div>
        <!-- /shape overlay -->
        <!-- image overlay -->
        <div ng-show="overlay == 'Image'">
          <ee-cloudinary-upload meta="collection" attr-target="'1000x1000'"></ee-cloudinary-upload>
          <div class="vert-10">OR</div>
          <ee-unsplash-search app-id="bb64366c7e2bfbc3d61c7425fe081f222a43e624dcd351c8ac6586525656c602"></ee-unsplash-search>
        </div>

        <!-- /image overlay -->
        <!-- product overlay -->
        <span ng-if="overlay == 'Product'"
          ng-repeat="product in products"
          ng-click="addImage({ url: product.image })" class="hover-pointer">
          <img ng-src="{{ product.image | cloudinaryResizeTo:120:120:'pad' }}"/>
        </span>
        <!-- /produt overlay -->
      </div>
      <!-- /Overlays -->
    </div>

    <div>
      <div class="ee-canvas-container" style="z-index: 10;">
        <!-- spacer for side scroll -->
        <!-- <div class="full-width visible-xs"
          style="height: 40px;"
          ng-if="canvasType == 'collection'">
        </div> -->
        <!-- /spacer for side scroll -->
        <!-- canvas -->
        <div class="position-relative">
          <canvas id="collection_canvas" ng-show="canvasType == 'collection'" width=800 height=420 class="gray-border "></canvas>
          <canvas id="logo_canvas" ng-show="canvasType == 'logo'" width=280 height=80 class="gray-border"></canvas>
          <div ng-if="blockCanvas" class="position-absolute top-left-bottom-right-0 white-background" style="z-index: 100; opacity: 0.2">
        </div>
        <!-- /canvas -->
      </div>
      <!-- icon for side scroll spacer -->
      <!-- <div class="position-absolute text-center gray-background visible-xs" style="top: 45px; left: 0; right: 0; height: 40px; z-index: 5"
        ng-if="canvasType == 'collection'">
        <i class="fa fa-3x fa-arrows-h text-muted"></i>
      </div> -->
      <!-- /icon for side scroll spacer -->
      </div>
    </div>
  </div>
  <div class="vert-5 margin-bottom-0">
    <div class="btn btn-primary" ng-click="upload()" ng-show="unsaved" ng-disabled="saving">Save image</div>
    <a class="btn btn-default" href="{{ banner | cloudinaryAttachment }}" ng-show="!unsaved">Download</a>
    <div class="btn btn-link" ng-click="preview()" ng-disabled="saving">Preview</div>
    <span ng-show="saving" class="btn btn-link text-muted disabled">Saving...</span>
    <div class="btn btn-link pull-right" ng-click="loadFromJSON()">Reset</div>
  </div>

  <ee-cloudinary-upload id="cloudinary_save" attr-target="'canvas'" class="hidden"></ee-cloudinary-upload>
</div>
